---
- include_tasks: debian.yml
  when: ansible_os_family == 'Debian'

- name: Create certs only
  command: certbot certonly --nginx --agree-tos -m {{ certbot_mail_address }} -n -d {{ site_name }}
  args:
    creates: "{{ certbot_crt }}"
  when: certbot_create_certs

- name: Renew certs every month
  cron:
    name: renewCertbotCerts
    minute: "{{ certbot_renew_certs_minute }}"
    hour: "{{ certbot_renew_certs_hour }}"
    month: "{{ certbot_renew_certs_month }}"
    weekday: "{{ certbot_renew_certs_weekday }}"
    job: /usr/bin/certbot renew -q
  when: certbot_create_certs
